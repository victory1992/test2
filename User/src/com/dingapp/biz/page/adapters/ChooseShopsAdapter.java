package com.dingapp.biz.page.adapters;import java.util.ArrayList;import java.util.List;import android.app.AlertDialog;import android.content.Context;import android.content.DialogInterface;import android.content.Intent;import android.net.Uri;import android.text.TextUtils;import android.view.LayoutInflater;import android.view.View;import android.view.View.OnClickListener;import android.view.ViewGroup;import android.widget.BaseAdapter;import android.widget.CheckBox;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.TextView;import com.dingapp.andriod.z20.R;import com.dingapp.biz.db.orm.ShopListBean;import com.dingapp.biz.util.ImageViewHWutils;import com.dingapp.core.app.BaseFragment;import com.dingapp.imageloader.core.ImageLoader;public class ChooseShopsAdapter extends BaseAdapter {	private Context context;	private List<ShopListBean> list = new ArrayList<ShopListBean>();	private int selectedPosition;	private BaseFragment bfBaseFragment;	public ChooseShopsAdapter(Context context, BaseFragment bfBaseFragment) {		this.context = context;		this.bfBaseFragment = bfBaseFragment;	}	public void setData(List<ShopListBean> list2) {		if (list2 != null) {			list.clear();			list.addAll(list2);		}		notifyDataSetChanged();	}	public void setSelectedPosition(int index) {		selectedPosition = index;	}	public int getSelectedPosition() {		return selectedPosition;	}	@Override	public int getCount() {		return list.size();	}	@Override	public Object getItem(int arg0) {		return list.get(arg0);	}	@Override	public long getItemId(int arg0) {		return arg0;	}	@Override	public View getView(int position, View convertView, ViewGroup arg2) {		ViewHolder holder = null;		if (convertView == null) {			holder = new ViewHolder();			convertView = LayoutInflater.from(context).inflate(					R.layout.item_choose_shops, null);			holder.iv_shops = (ImageView) convertView					.findViewById(R.id.iv_item_shops);			holder.cb_selected = (CheckBox) convertView					.findViewById(R.id.cb_selected_shops);			holder.tv_shops_title = (TextView) convertView					.findViewById(R.id.tv_item_shops_title);			holder.tv_shops_phone = (TextView) convertView					.findViewById(R.id.tv_item_shopsphone);			holder.tv_shops_address = (TextView) convertView					.findViewById(R.id.tv_item_shopaddress);			holder.ll_shops_phone = (LinearLayout) convertView					.findViewById(R.id.ll_choose_shops_phone);			convertView.setTag(holder);		} else {			holder = (ViewHolder) convertView.getTag();		}		if (position == selectedPosition) {			holder.cb_selected.setChecked(true);		} else {			holder.cb_selected.setChecked(false);		}		holder.itemPosition = position;		ShopListBean bean = (ShopListBean) getItem(position);		if (bean != null) {			if (bean.getMerchant_pic() != null					&& !TextUtils.isEmpty(bean.getMerchant_pic()							.getDetail_url())) {				ImageLoader.getInstance().displayImage(						bean.getMerchant_pic().getDetail_url()								+ ImageViewHWutils.getWHImageVIew(300, 300),						holder.iv_shops);			}			holder.tv_shops_address.setText(bean.getMerchant_address());			holder.tv_shops_title.setText(bean.getMerchant_nick());			holder.tv_shops_phone.setText(bean.getMerchant_mobile());			holder.ll_shops_phone.setTag(holder);			holder.ll_shops_phone.setOnClickListener(new OnClickListener() {				@Override				public void onClick(View v) {					Object tag = v.getTag();					int itemPosition = -1;					if (tag instanceof ViewHolder) {						itemPosition = ((ViewHolder) tag).itemPosition;					}					if (itemPosition == -1) {						return;					}					final ShopListBean bean = (ShopListBean) getItem(itemPosition);					AlertDialog.Builder builder = new AlertDialog.Builder(							context);					builder.setTitle("一键预约: ");					builder.setMessage("确定要拨打电话:" + bean.getMerchant_mobile()							+ "吗？");					builder.setNegativeButton("取消",							new DialogInterface.OnClickListener() {								@Override								public void onClick(DialogInterface dialog,										int which) {									dialog.dismiss();								}							});					builder.setPositiveButton("确定",							new DialogInterface.OnClickListener() {								@Override								public void onClick(DialogInterface dialog,										int which) {									dialog.dismiss();									Intent intent = new Intent(											Intent.ACTION_DIAL,											Uri.parse("tel:"													+ bean.getMerchant_mobile()));									bfBaseFragment.startActivity(intent);								}							});					builder.create().show();				}			});		}		return convertView;	}	static class ViewHolder {		private ImageView iv_shops;		private TextView tv_shops_title;		private TextView tv_shops_address;		private TextView tv_shops_phone;		private LinearLayout ll_shops_phone;		private CheckBox cb_selected;		private int itemPosition;	}}